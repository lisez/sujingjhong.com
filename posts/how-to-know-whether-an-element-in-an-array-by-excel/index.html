<!doctype html><html lang=zh-tw><head><meta name=generator content="Hugo 0.80.0"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="今天在臉書上看到一位朋友提問，他的問題是這樣的： 如果我要在B欄呈現「該列的A欄的值如果等於C欄任意一列的值的話，就在該列的B欄打V（例如A1"><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="在Excel判斷欄位值是否在陣列裡"><meta property="og:description" content="今天在臉書上看到一位朋友提問，他的問題是這樣的： 如果我要在B欄呈現「該列的A欄的值如果等於C欄任意一列的值的話，就在該列的B欄打V（例如A1"><meta property="og:type" content="article"><meta property="og:url" content="https://sujingjhong.com/posts/how-to-know-whether-an-element-in-an-array-by-excel/"><meta property="article:published_time" content="2017-09-17T00:11:00+08:00"><meta property="article:modified_time" content="2017-09-17T00:11:00+08:00"><title>在Excel判斷欄位值是否在陣列裡 | sujj blog</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.8190e12bf2e7cffb0627f499d2a501d965407366c8ba87328686cd3651efad15.css integrity="sha256-gZDhK/Lnz/sGJ/SZ0qUB2WVAc2bIuocyhobNNlHvrRU="><script defer src=/zh-tw.search.min.f50f100d968c44c2ef6c01b5979a501884a20d78597f8e836760387f75a1f2d8.js integrity="sha256-9Q8QDZaMRMLvbAG1l5pQGISiDXhZf46DZ2A4f3Wh8tg="></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-139857297-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><link rel=canonical href=https://sujingjhong.com/posts/how-to-know-whether-an-element-in-an-array-by-excel/><link rel=index href=https://sujingjhong.composts><link rel=home href=https://sujingjhong.com><link rel=license href=http://creativecommons.org/licenses/by-nc/4.0/><link rel=preload href=https://cdn.commento.io/js/commento.js as=script><script defer src=https://cdn.commento.io/js/commento.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/prism-themes@1.4.0/themes/prism-ghcolors.css crossorigin=anonymous media=none onload="if(media!='all')media='all'"><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/prismjs@1.20.0/plugins/line-numbers/prism-line-numbers.css crossorigin=anonymous onload="if(media!='all')media='all'"><script defer src=https://cdn.jsdelivr.net/npm/mermaid@8.0.0/dist/mermaid.min.js crossorigin=anonymous onload=mermaid.initialize({startOnLoad:true});></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.20.0/components/prism-core.min.js crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.20.0/plugins/autoloader/prism-autoloader.min.js crossorigin=anonymous onload="Prism.plugins.autoloader.languages_path='https://cdn.jsdelivr.net/npm/prismjs@1.20.0/components/';"></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.20.0/plugins/line-numbers/prism-line-numbers.min.js crossorigin=anonymous onload="document.querySelectorAll('pre>code').forEach(function(e){e.classList.add('line-numbers')});"></script><script type=application/ld+json>[{"@context":"https://schema.org","@type":"BlogPosting","headline":"在Excel判斷欄位值是否在陣列裡","image":"https://sujingjhong.com","datePublished":"2017-09-17T00:11:00+08:00","dateModified":"2017-09-17T00:11:00+08:00","author":{"@type":"Person","name":"Su Jing Jhong"},"mainEntityOfPage":{"@type":"WebPage"},"publisher":{"@type":"Organization","name":"lisez","logo":{"@type":"ImageObject","url":null}},"description":"今天在臉書上看到一位朋友提問，他的問題是這樣的： 如果我要在B欄呈現「該列的A欄的值如果等於C欄任意一列的值的話，就在該列的B欄打V（例如A1","keywords":["JavaScript","Excel","tutorial"]},{"@context":"https://schema.org","@type":"Organization","name":"lisez","url":"https://sujingjhong.com","sameAs":["https://www.npmjs.com/~lisez","https://www.linkedin.com/in/jing-jhong-su/","https://github.com/lisez","https://medium.com/@sujj","https://vocus.cc/flyingwhale/","https://vocus.cc/loghowisurvived/"]}]</script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>sujj blog</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder aria-label maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/about/>關於我</a></li><li><a href=/search/>站內搜尋</a></li><li><a href=/posts/>文章清單</a></li><li><a href=/posts/elixir101/>Elixir101</a></li><li><a href=/posts/eng-class/>英文筆記</a></li><li><a href=/posts/foreignpolicy/>外交政策</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>在Excel判斷欄位值是否在陣列裡</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents></nav></aside></header><article class=markdown><h1>在Excel判斷欄位值是否在陣列裡</h1><section><h5>September 17, 2017</h5><ul class=tags><li class="mark-block tag-block"><a href=https://sujingjhong.com/tags/javascript/>JavaScript</a></li><li class="mark-block tag-block"><a href=https://sujingjhong.com/tags/excel/>Excel</a></li><li class="mark-block tag-block"><a href=https://sujingjhong.com/tags/tutorial/>tutorial</a></li></ul></section><section class=content><p>今天在臉書上看到一位朋友提問，他的問題是這樣的：</p><blockquote><p>如果我要在B欄呈現「該列的A欄的值如果等於C欄任意一列的值的話，就在該列的B欄打V（例如A1的值是2=C欄中的2，所以在B1打V；A6的值是7=C欄中的7，所以也要在B6打V）」</p></blockquote><p>這是他的問題範例，以及預期的最終結果：</p><table><thead><tr><th><strong>#</strong></th><th><strong>A</strong></th><th><strong>B</strong></th><th><strong>C</strong></th></tr></thead><tbody><tr><td><strong>1</strong></td><td>2</td><td>V</td><td>2</td></tr><tr><td><strong>2</strong></td><td>5</td><td>V</td><td>5</td></tr><tr><td><strong>3</strong></td><td>8</td><td>V</td><td>8</td></tr><tr><td><strong>4</strong></td><td>6</td><td></td><td>7</td></tr><tr><td><strong>5</strong></td><td>8</td><td>V</td><td></td></tr><tr><td><strong>6</strong></td><td>7</td><td>V</td><td></td></tr><tr><td><strong>7</strong></td><td>3</td><td></td><td></td></tr><tr><td><strong>8</strong></td><td>7</td><td>V</td><td></td></tr><tr><td><strong>9</strong></td><td>4</td><td></td><td></td></tr><tr><td><strong>10</strong></td><td>3</td><td></td><td></td></tr></tbody></table><p>他的問題整理下就是：</p><blockquote><p>當元素屬於特定一個陣列的元素時，顯示「V」，否則就不做任何事。</p></blockquote><p>這時候我們可以把問題拆解成下列步驟來實現：</p><ol><li>特定一個陣列範圍，用來檢查元素（把它稱為檢查陣列）</li><li>當一個元素屬於檢查陣列元素時，顯示<code>Ｖ</code></li><li>當一個元素不屬於檢查陣列元素時，不做任何事。</li></ol><p>那2, 3就是邏輯控制：<code>if ... is true then ..., else ...</code>。可以用 Excel中的 <a href=https://support.office.com/zh-tw/article/IF-%E5%87%BD%E6%95%B8-69aed7c9-4e8a-4755-a9bc-aa8bbff73be2>IF函數</a> 來處理。</p><p>所以這時候問題就聚焦在「<strong>在Excel中如何判斷一個元素是否屬於特定陣列</strong>」</p><p>如果是在JavaScript裡，就會很直覺的使用 <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes>Array.prototype.includes()</a>。例如就可以解成：</p><pre><code class=language-javascript>const validNums=[2, 5, 8, 7];
const nums=[2, 5, 8, 6, 8, 7, 3, 7, 4, 3];
nums.forEach(num=&gt;{
    if(validNums.includes(num)){
        console.log(`${num} =&gt; V`);
    }else{
        console.log(`${num} =&gt;`);
    }
});

// 2 =&gt; V
// 5 =&gt; V
// 8 =&gt; V
// 6 =&gt;
// 8 =&gt; V
// 7 =&gt; V
// 3 =&gt;
// 7 =&gt; V
// 4 =&gt;
// 3 =&gt;
</code></pre><p>那在Excel中該如何解？Excel中用來查表函數主要有<code>VLOOKUP</code>、<code>HLOOKUP</code>、<code>MATCH</code>、<code>INDEX</code>。</p><p>在這裡我主要利用<code>MATCH</code>來解，為什麼用<code>MATCH</code>？</p><ul><li><code>INDEX</code>主要是以索引值返回元素(search by index)，但我們這裡則反過來，是要用元素來查詢其是否在特定陣列裡面(search by value)。</li><li><code>VLOOKUP</code>、<code>HLOOKUP</code>主要是查詢到後，返回指定欄（列）的值，那還需要在Ｃ欄後增設一欄用來賦值，會再多費工。</li></ul><p>那我們參照<a href=https://support.office.com/zh-tw/article/MATCH-%E5%87%BD%E6%95%B8-e8dffd45-c762-47d6-bf89-533f4a37673a>官方文件</a>後，剖析一下match函數式：</p><pre><code class=language-EXCEL>=MATCH(lookup_value, lookup_array, [match_type])
</code></pre><p>代表我們需要⋯⋯</p><ul><li>需要比對的數值(lookup_value)</li><li>需要搜尋的範圍(lookup_array)</li><li>MATCH函數該如何進行比對？(match_type)</li></ul><p>那我們需要比對的數值，就是A欄的數值<code>A1, A2, A3...</code>，這些可以寫好公式，直接利用Excel自動填入即可。</p><p>再來需要搜尋範圍，就是C欄的陣列數值，就是<code>C1:C4</code>。</p><p>接著<code>MATCH</code>該如何運作？我們是需要精確的比對，所以輸入 <code>0</code>。</p><p>最後我們可以完成函數式，我們以需要比對<code>A1</code>值是否屬於C欄值為例，所以我們是需要在<code>B1</code>填入公式：</p><pre><code class=language-EXCEL>=MATCH(A1, $C$1:$C$4, 0)
</code></pre><p>不過到這裡還不太正確，我們是需要在比對到時，回傳<code>V</code>，所以在外面再包一層IF函數：</p><pre><code class=language-EXCEL>=IF(MATCH(A1, $C$1:$C$4, 0), &quot;V&quot;, &quot;&quot;)
</code></pre><p>接著把它拉到其他列，讓程式協助我們自動完成：</p><p><img src=/images/excel-tutorial-20170917-1.png alt=圖二></p><p>咦？怎麼顯示<code>#N/A</code>了？</p><p>讓我們重新查一下文件，原來⋯⋯</p><blockquote><ul><li><strong>MATCH</strong> 會傳回 <strong>lookup_array</strong> 內相符值的位置，而非值本身。例如，<strong>MATCH(&ldquo;b&rdquo;,{&ldquo;a&rdquo;,&ldquo;b&rdquo;,&ldquo;c&rdquo;},0)</strong> 會傳回 2，這是陣列 {&ldquo;a&rdquo;,&ldquo;b&rdquo;,&ldquo;c&rdquo;} 內 &ldquo;b&rdquo; 的相對位置。</li><li>&mldr;</li><li>如果 <strong>MATCH</strong> 函數無法找到符合的項目，則傳回 #N/A 錯誤值。</li><li>&mldr;</li></ul></blockquote><p>那這時候代表：</p><ol><li>當<code>MATCH</code>函數找到符合項目時，會回傳位置，不會回傳<code>#N/A</code>。</li><li>當<code>MATCH</code>函數找不到時，會回傳<code>#N/A</code>。</li></ol><p>那連結回我們要解決的問題就是：</p><ol><li>當找到元素時，顯示<code>V</code>；找不到元素時，不做任何事，但也不應該顯示錯誤。所以說當找不到元素時，應該讓欄位顯示空白值，空白值就是<code>""</code></li><li>而MATCH函數找到元素時，會回傳位置，不會回傳<code>#N/A</code>，這時候應該顯示V；找不到元素時，會回傳<code>#N/A</code>，這時候應該顯示空白值。</li></ol><p>簡單講就是：</p><ul><li>找到了，不會回傳<code>#N/A</code>，而是會回傳數字。</li><li>沒找到，會回傳<code>#N/A</code>。</li></ul><p>那我們要做的就是，判斷他回傳是不是<code>#N/A</code>，如果是<code>#N/A</code>就顯示空白值，不是的話，就顯示<code>V</code>。</p><p>那在EXCEL中，判斷是否為<code>#N/A</code>的話，<a href=https://support.office.com/zh-tw/article/IS-%E5%87%BD%E6%95%B8-0f2d7971-6019-40a0-a171-f2d869135665>可以用ISERROR()或者ISNA()</a>。</p><p>所以我們就可以改成：</p><pre><code class=language-EXCEL>=IF(ISNA(MATCH(A1, $C$1:$C$4, 0)), &quot;&quot;, &quot;V&quot;)
</code></pre><p>讓我們再重新拉一次⋯⋯</p><p><img src=/images/excel-tutorial-20170917-2.png alt=圖二></p><p>成功！</p></section></article><section><h2>給我讚！</h2><iframe data-v-456d30bd scrolling=no src="https://button.like.co/in/embed/lisez0618/button?type=wp&referrer=https%3a%2f%2fsujingjhong.com%2fposts%2fhow-to-know-whether-an-element-in-an-array-by-excel%2f" class="lc-margin-top-64 lc-margin-bottom-32 lc-mobile" frameborder=0 style=width:100%;height:212px></iframe></section><section class=share-buttons><h2>認同請分享</h2><ul class=share-buttons><li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fsujingjhong.com%2fposts%2fhow-to-know-whether-an-element-in-an-array-by-excel%2f%3futm_campaign%3dShare%26utm_medium%3dSocial%26utm_source%3dFacebook&quote=%e5%9c%a8Excel%e5%88%a4%e6%96%b7%e6%ac%84%e4%bd%8d%e5%80%bc%e6%98%af%e5%90%a6%e5%9c%a8%e9%99%a3%e5%88%97%e8%a3%a1" title="Share on Facebook" target=_blank><img alt="Share on Facebook" src=/images/flat_web_icon_set/color/Facebook.png></a></li><li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2fsujingjhong.com%2fposts%2fhow-to-know-whether-an-element-in-an-array-by-excel%2f%3futm_campaign%3dShare%26utm_medium%3dSocial%26utm_source%3dTwitter&text=%e5%9c%a8Excel%e5%88%a4%e6%96%b7%e6%ac%84%e4%bd%8d%e5%80%bc%e6%98%af%e5%90%a6%e5%9c%a8%e9%99%a3%e5%88%97%e8%a3%a1:%20https%3a%2f%2fsujingjhong.com%2fposts%2fhow-to-know-whether-an-element-in-an-array-by-excel%2f%3futm_campaign%3dShare%26utm_medium%3dSocial%26utm_source%3dTwitter" target=_blank title=Tweet><img alt=Tweet src=/images/flat_web_icon_set/color/Twitter.png></a></li><li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2fsujingjhong.com%2fposts%2fhow-to-know-whether-an-element-in-an-array-by-excel%2f%3futm_campaign%3dShare%26utm_medium%3dSocial%26utm_source%3dTumblr&quote=%e5%9c%a8Excel%e5%88%a4%e6%96%b7%e6%ac%84%e4%bd%8d%e5%80%bc%e6%98%af%e5%90%a6%e5%9c%a8%e9%99%a3%e5%88%97%e8%a3%a1&s=" target=_blank title="Post to Tumblr"><img alt="Post to Tumblr" src=/images/flat_web_icon_set/color/Tumblr.png></a></li><li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fsujingjhong.com%2fposts%2fhow-to-know-whether-an-element-in-an-array-by-excel%2f%3futm_campaign%3dShare%26utm_medium%3dSocial%26utm_source%3dPinterest&description=" target=_blank title="Pin it"><img alt="Pin it" src=/images/flat_web_icon_set/color/Pinterest.png></a></li><li><a href="https://getpocket.com/save?url=https%3a%2f%2fsujingjhong.com%2fposts%2fhow-to-know-whether-an-element-in-an-array-by-excel%2f%3futm_campaign%3dShare%26utm_medium%3dReferral%26utm_source%3dPocket&title=%e5%9c%a8Excel%e5%88%a4%e6%96%b7%e6%ac%84%e4%bd%8d%e5%80%bc%e6%98%af%e5%90%a6%e5%9c%a8%e9%99%a3%e5%88%97%e8%a3%a1" target=_blank title="Add to Pocket"><img alt="Add to Pocket" src=/images/flat_web_icon_set/color/Pocket.png></a></li><li><a href="http://www.reddit.com/submit?url=https%3a%2f%2fsujingjhong.com%2fposts%2fhow-to-know-whether-an-element-in-an-array-by-excel%2f%3futm_campaign%3dShare%26utm_medium%3dSocial%26utm_source%3dReddit&title=%e5%9c%a8Excel%e5%88%a4%e6%96%b7%e6%ac%84%e4%bd%8d%e5%80%bc%e6%98%af%e5%90%a6%e5%9c%a8%e9%99%a3%e5%88%97%e8%a3%a1" target=_blank title="Submit to Reddit"><img alt="Submit to Reddit" src=/images/flat_web_icon_set/color/Reddit.png></a></li><li><a href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fsujingjhong.com%2fposts%2fhow-to-know-whether-an-element-in-an-array-by-excel%2f%3futm_campaign%3dShare%26utm_medium%3dSocial%26utm_source%3dLinkedin&title=%e5%9c%a8Excel%e5%88%a4%e6%96%b7%e6%ac%84%e4%bd%8d%e5%80%bc%e6%98%af%e5%90%a6%e5%9c%a8%e9%99%a3%e5%88%97%e8%a3%a1&summary=&source=https%3a%2f%2fsujingjhong.com%2fposts%2fhow-to-know-whether-an-element-in-an-array-by-excel%2f%3futm_campaign%3dShare%26utm_medium%3dSocial%26utm_source%3dLinkedin" target=_blank title="Share on LinkedIn"><img alt="Share on LinkedIn" src=/images/flat_web_icon_set/color/LinkedIn.png></a></li><li><a href="http://wordpress.com/press-this.php?u=https%3a%2f%2fsujingjhong.com%2fposts%2fhow-to-know-whether-an-element-in-an-array-by-excel%2f%3futm_campaign%3dShare%26utm_medium%3dReferral%26utm_source%3dWordpress&quote=%e5%9c%a8Excel%e5%88%a4%e6%96%b7%e6%ac%84%e4%bd%8d%e5%80%bc%e6%98%af%e5%90%a6%e5%9c%a8%e9%99%a3%e5%88%97%e8%a3%a1&s=" target=_blank title="Publish on WordPress"><img alt="Publish on WordPress" src=/images/flat_web_icon_set/color/Wordpress.png></a></li><li><a href="https://pinboard.in/popup_login/?url=https%3a%2f%2fsujingjhong.com%2fposts%2fhow-to-know-whether-an-element-in-an-array-by-excel%2f%3futm_campaign%3dShare%26utm_medium%3dSocial%26utm_source%3dPinboard&title=%e5%9c%a8Excel%e5%88%a4%e6%96%b7%e6%ac%84%e4%bd%8d%e5%80%bc%e6%98%af%e5%90%a6%e5%9c%a8%e9%99%a3%e5%88%97%e8%a3%a1&description=" target=_blank title="Save to Pinboard"><img alt="Save to Pinboard" src=/images/flat_web_icon_set/color/Pinboard.png></a></li><li><a href="mailto:?subject=%e5%9c%a8Excel%e5%88%a4%e6%96%b7%e6%ac%84%e4%bd%8d%e5%80%bc%e6%98%af%e5%90%a6%e5%9c%a8%e9%99%a3%e5%88%97%e8%a3%a1&body=:%20https%3a%2f%2fsujingjhong.com%2fposts%2fhow-to-know-whether-an-element-in-an-array-by-excel%2f%3futm_campaign%3dShare%26utm_medium%3dEmail%26utm_source%3dEmail" target=_blank title="Send email"><img alt="Send email" src=/images/flat_web_icon_set/color/Email.png></a></li></ul></section><h2 id=相關文章>相關文章</h2><ul class=related><li><a href=/posts/golang-gvm-for-go/>Golang / GVM for Go</a></li><li><a href=/posts/jquery-onclick-vs-touchstart/>Jquery Onclick vs Touchstart</a></li><li><a href=/posts/get-url-arguments-and-upload-to-server-but-not-working/>取得URL參數值、上傳伺服器沒有反應問題</a></li><li><a href=/posts/node-js-1-node-gyp-xcode-select-error/>[node.js] #1 node-gyp: xcode-select error</a></li><li><a href=/posts/how-to-deploy-hugo-automatically-with-github-actions/>Hugo / 如何使用 Github Actions 自動部署 Hugo</a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><hr><div id=commento></div><footer><span class=copyright>© 2019-2021 Su Jing Jhong 版權所有
<a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/ target=_blank><img alt="創用 CC 授權條款" style=border-width:0 src=https://i.creativecommons.org/l/by-nc/4.0/80x15.png></a></span></footer></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents></nav></aside></main><script defer>var links=document.getElementsByTagName("a");for(var i=0;i<links.length;i++){if(links[i].hostname!=window.location.hostname){links[i].target='_blank';}}</script></body></html>